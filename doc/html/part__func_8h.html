<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RNAlib-2.0.4: H/part_func.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>H/part_func.h File Reference</h1>
<p>Partition function of single RNA sequences.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Include dependency graph for part_func.h:</div>
<div class="dynsection">
<div class="center"><img src="part__func_8h__incl.png" border="0" usemap="#H_2part__func_8h_map" alt=""/></div>
<map name="H_2part__func_8h_map" id="H_2part__func_8h">
<area shape="rect" id="node3" href="data__structures_8h.html" title="All datastructures and typedefs shared among the Vienna RNA Package can be found..." alt="" coords="5,86,128,117"/><area shape="rect" id="node5" href="energy__const_8h.html" title="energy constants" alt="" coords="12,166,121,197"/></map>
</div>

<p><a href="part__func_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a1839c61275760944b3a007c41d5c0823">pf_fold_par</a> (const char *sequence, char *structure, <a class="el" href="structpf__paramT.html">pf_paramT</a> *parameters, int calculate_bppm, int is_constrained, int is_circular)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the partition function <img class="formulaInl" alt="$Q$" src="form_14.png"/> for a given RNA sequence.  <a href="#a1839c61275760944b3a007c41d5c0823"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2">pf_fold</a> (const char *sequence, char *structure)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the partition function <img class="formulaInl" alt="$Q$" src="form_14.png"/> of an RNA sequence.  <a href="#adc3db3d98742427e7001a7fd36ef28c2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735">pf_circ_fold</a> (const char *sequence, char *structure)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the partition function of a circular RNA sequence.  <a href="#a819ce5fca8984004ac81c4a3b04cb735"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ac03ca6db186bb3bf0a2a326d7fb3ba03">pbacktrack</a> (char *sequence)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sample a secondary structure from the Boltzmann ensemble according its probability<br/>
.  <a href="#ac03ca6db186bb3bf0a2a326d7fb3ba03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a00474051204ac9ad576b3e45174d03ff">pbacktrack_circ</a> (char *sequence)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sample a secondary structure of a circular RNA from the Boltzmann ensemble according its probability.  <a href="#a00474051204ac9ad576b3e45174d03ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ae73db3f49a94f0f72e067ecd12681dbd">free_pf_arrays</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free arrays for the partition function recursions.  <a href="#ae73db3f49a94f0f72e067ecd12681dbd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a384e927890f9c034ff09fa66da102d28">update_pf_params</a> (int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Recalculate energy parameters.  <a href="#a384e927890f9c034ff09fa66da102d28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">FLT_OR_DBL *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ac5ac7ee281aae1c5cc5898a841178073">export_bppm</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pointer to the base pair probability array.  <a href="#ac5ac7ee281aae1c5cc5898a841178073"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a2f29542659beb5ebd176631a3da11580">assign_plist_from_pr</a> (<a class="el" href="structplist.html">plist</a> **pl, FLT_OR_DBL *probs, int length, double cutoff)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a plist from a probability matrix.  <a href="#a2f29542659beb5ebd176631a3da11580"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a42faebdfce6f070c5f89adfc8427525c">get_pf_arrays</a> (short **S_p, short **S1_p, char **ptype_p, FLT_OR_DBL **qb_p, FLT_OR_DBL **qm_p, FLT_OR_DBL **q1k_p, FLT_OR_DBL **qln_p)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the pointers to (almost) all relavant computation arrays used in partition function computation.  <a href="#a42faebdfce6f070c5f89adfc8427525c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a189e2a1ec6cc32c53ea72f7543b0441e"></a><!-- doxytag: member="part_func.h::get_subseq_F" ref="a189e2a1ec6cc32c53ea72f7543b0441e" args="(int i, int j)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a189e2a1ec6cc32c53ea72f7543b0441e">get_subseq_F</a> (int i, int j)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the free energy of a subsequence from the q[] array. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a9aba0ba1433a6d259331e0fe9fc4a9a6">get_centroid_struct_pl</a> (int length, double *dist, <a class="el" href="structplist.html">plist</a> *pl)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the centroid structure of the ensemble.  <a href="#a9aba0ba1433a6d259331e0fe9fc4a9a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ac92486ce514677256f4a832dc518759c">get_centroid_struct_pr</a> (int length, double *dist, FLT_OR_DBL *<a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f">pr</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the centroid structure of the ensemble.  <a href="#ac92486ce514677256f4a832dc518759c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a79cbc375af65f11609feb6b055269e7d">mean_bp_distance</a> (int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the mean base pair distance of the last partition function computation.  <a href="#a79cbc375af65f11609feb6b055269e7d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ad5ba36cef8d01cf4244cc09b9bf1ce1d">mean_bp_distance_pr</a> (int length, FLT_OR_DBL *<a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f">pr</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the mean base pair distance in the thermodynamic ensemble.  <a href="#ad5ba36cef8d01cf4244cc09b9bf1ce1d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a129d81c4a1ead793c5b2311333e03dfa"></a><!-- doxytag: member="part_func.h::bppm_to_structure" ref="a129d81c4a1ead793c5b2311333e03dfa" args="(char *structure, FLT_OR_DBL *pr, unsigned int length)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a129d81c4a1ead793c5b2311333e03dfa">bppm_to_structure</a> (char *structure, FLT_OR_DBL *<a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f">pr</a>, unsigned int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a dot-bracket like structure string from base pair probability matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49962ad6242b8c628de6ca16bb831c1d"></a><!-- doxytag: member="part_func.h::bppm_symbol" ref="a49962ad6242b8c628de6ca16bb831c1d" args="(const float *x)" -->
char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a49962ad6242b8c628de6ca16bb831c1d">bppm_symbol</a> (const float *x)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a pseudo dot bracket notation for a given probability information. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a15176e23eceeff8c7d14eabcfec8a2af">init_pf_fold</a> (int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate space for <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>.  <a href="#a15176e23eceeff8c7d14eabcfec8a2af"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ae89a63bd83e75a80b2ba36d20b31ce81">centroid</a> (int length, double *dist)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#ae9556ba7ded44fe2321b6f67c3fc02a3">mean_bp_dist</a> (int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get the mean pair distance of ensemble  <a href="#ae9556ba7ded44fe2321b6f67c3fc02a3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a68ba6f3a48e08ca131ab54621ce3a2d7">expLoopEnergy</a> (int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#a7b6ab474cc80accc48010ccfcc59f96b">expHairpinEnergy</a> (int u, int type, short si1, short sj1, const char *string)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd79b1a570e6ad9be24cb11fe8cae30a"></a><!-- doxytag: member="part_func.h::st_back" ref="acd79b1a570e6ad9be24cb11fe8cae30a" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func_8h.html#acd79b1a570e6ad9be24cb11fe8cae30a">st_back</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">a flag indicating that auxilary arrays are needed throughout the computations which are necessary for stochastic backtracking <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Partition function of single RNA sequences. </p>
<p>This file includes (almost) all function declarations within the <b>RNAlib</b> that are related to Partion function folding...</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If you plan on using the functions provided from this section of the RNAlib concurrently via <b>OpenMP</b> you have to place a <em>COPYIN</em> clause right before your <em>PARALLEL</em> directive! Otherwise, some functions may not behave as expected. A complete list of variables that have to be passed to the <em>COPYIN</em> clause can be found in the detailed description of each function below. </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1839c61275760944b3a007c41d5c0823"></a><!-- doxytag: member="part_func.h::pf_fold_par" ref="a1839c61275760944b3a007c41d5c0823" args="(const char *sequence, char *structure, pf_paramT *parameters, int calculate_bppm, int is_constrained, int is_circular)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pf_fold_par </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpf__paramT.html">pf_paramT</a> *&nbsp;</td>
          <td class="paramname"> <em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>calculate_bppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>is_constrained</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>is_circular</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the partition function <img class="formulaInl" alt="$Q$" src="form_14.png"/> for a given RNA sequence. </p>
<p>If <em>structure</em> is not a NULL pointer on input, it contains on return a string consisting of the letters " . , | { } ( ) " denoting bases that are essentially unpaired, weakly paired, strongly paired without preference, weakly upstream (downstream) paired, or strongly up- (down-)stream paired bases, respectively. If <a class="el" href="fold__vars_8h.html#a0afc287c2464866d94858c39175154af" title="Global switch to activate/deactivate folding with structure constraints.">fold_constrained</a> is not 0, the <em>structure</em> string is interpreted on input as a list of constraints for the folding. The character "x" marks bases that must be unpaired, matching brackets " ( ) " denote base pairs, all other characters are ignored. Any pairs conflicting with the constraint will be forbidden. This is usually sufficient to ensure the constraints are honored. If tha parameter calculate_bppm is set to 0 base pairing probabilities will not be computed (saving CPU time), otherwise after calculations took place <a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f" title="A pointer to the base pair probability matrix.">pr</a> will contain the probability that bases <em>i</em> and <em>j</em> pair. <dl class="note"><dt><b>Note:</b></dt><dd>The global array <a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f" title="A pointer to the base pair probability matrix.">pr</a> is deprecated and the user who wants the calculated base pair probabilities for further computations is advised to use the function <a class="el" href="part__func_8h.html#ac5ac7ee281aae1c5cc5898a841178073" title="Get a pointer to the base pair probability array.">export_bppm()</a></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a>, <a class="el" href="part__func_8h.html#a129d81c4a1ead793c5b2311333e03dfa" title="Create a dot-bracket like structure string from base pair probability matrix.">bppm_to_structure()</a>, <a class="el" href="part__func_8h.html#ac5ac7ee281aae1c5cc5898a841178073" title="Get a pointer to the base pair probability array.">export_bppm()</a>, <a class="el" href="params_8h.html#a6fc2f3eef5a3024d44963ac59a42e39d" title="Get precomputed Boltzmann factors of the loop type dependent energy contributions...">get_boltzmann_factors()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequence</em>&nbsp;</td><td>The RNA sequence input <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>structure</em>&nbsp;</td><td>A pointer to a char array where a base pair probability information can be stored in a pseudo-dot-bracket notation (may be NULL, too) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>parameters</em>&nbsp;</td><td>Data structure containing the precalculated Boltzmann factors <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>calculate_bppm</em>&nbsp;</td><td>Switch to Base pair probability calculations on/off (0==off) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>is_constrained</em>&nbsp;</td><td>Switch to indicate that a structure contraint is passed via the structure argument (0==off) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>is_circular</em>&nbsp;</td><td>Switch to (de-)activate postprocessing steps in case RNA sequence is circular (0==off) <dl class="return"><dt><b>Returns:</b></dt><dd>The Gibbs free energy of the ensemble (<img class="formulaInl" alt="$G = -RT \cdot \log(Q) $" src="form_15.png"/>) in kcal/mol </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adc3db3d98742427e7001a7fd36ef28c2"></a><!-- doxytag: member="part_func.h::pf_fold" ref="adc3db3d98742427e7001a7fd36ef28c2" args="(const char *sequence, char *structure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pf_fold </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>structure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the partition function <img class="formulaInl" alt="$Q$" src="form_14.png"/> of an RNA sequence. </p>
<p>If <em>structure</em> is not a NULL pointer on input, it contains on return a string consisting of the letters " . , | { } ( ) " denoting bases that are essentially unpaired, weakly paired, strongly paired without preference, weakly upstream (downstream) paired, or strongly up- (down-)stream paired bases, respectively. If <a class="el" href="fold__vars_8h.html#a0afc287c2464866d94858c39175154af" title="Global switch to activate/deactivate folding with structure constraints.">fold_constrained</a> is not 0, the <em>structure</em> string is interpreted on input as a list of constraints for the folding. The character "x" marks bases that must be unpaired, matching brackets " ( ) " denote base pairs, all other characters are ignored. Any pairs conflicting with the constraint will be forbidden. This is usually sufficient to ensure the constraints are honored. If <a class="el" href="fold__vars_8h.html#ad512b5dd4dbec60faccfe137bb474489" title="do backtracking, i.e.">do_backtrack</a> has been set to 0 base pairing probabilities will not be computed (saving CPU time), otherwise <a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f" title="A pointer to the base pair probability matrix.">pr</a> will contain the probability that bases <em>i</em> and <em>j</em> pair. <dl class="note"><dt><b>Note:</b></dt><dd>The global array <a class="el" href="fold__vars_8h.html#ac98ec419070aee6831b44e5c700f090f" title="A pointer to the base pair probability matrix.">pr</a> is deprecated and the user who wants the calculated base pair probabilities for further computations is advised to use the function <a class="el" href="part__func_8h.html#ac5ac7ee281aae1c5cc5898a841178073" title="Get a pointer to the base pair probability array.">export_bppm()</a></dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a>, <a class="el" href="part__func_8h.html#a129d81c4a1ead793c5b2311333e03dfa" title="Create a dot-bracket like structure string from base pair probability matrix.">bppm_to_structure()</a>, <a class="el" href="part__func_8h.html#ac5ac7ee281aae1c5cc5898a841178073" title="Get a pointer to the base pair probability array.">export_bppm()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequence</em>&nbsp;</td><td>The RNA sequence input <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>structure</em>&nbsp;</td><td>A pointer to a char array where a base pair probability information can be stored in a pseudo-dot-bracket notation (may be NULL, too) <dl class="return"><dt><b>Returns:</b></dt><dd>The Gibbs free energy of the ensemble (<img class="formulaInl" alt="$G = -RT \cdot \log(Q) $" src="form_15.png"/>) in kcal/mol </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a819ce5fca8984004ac81c4a3b04cb735"></a><!-- doxytag: member="part_func.h::pf_circ_fold" ref="a819ce5fca8984004ac81c4a3b04cb735" args="(const char *sequence, char *structure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pf_circ_fold </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>structure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the partition function of a circular RNA sequence. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>, <a class="el" href="part__func_8h.html#a1839c61275760944b3a007c41d5c0823" title="Compute the partition function  for a given RNA sequence.">pf_fold_par()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequence</em>&nbsp;</td><td>The RNA sequence input <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>structure</em>&nbsp;</td><td>A pointer to a char array where a base pair probability information can be stored in a pseudo-dot-bracket notation (may be NULL, too) <dl class="return"><dt><b>Returns:</b></dt><dd>The Gibbs free energy of the ensemble (<img class="formulaInl" alt="$G = -RT \cdot \log(Q) $" src="form_15.png"/>) in kcal/mol </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac03ca6db186bb3bf0a2a326d7fb3ba03"></a><!-- doxytag: member="part_func.h::pbacktrack" ref="ac03ca6db186bb3bf0a2a326d7fb3ba03" args="(char *sequence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* pbacktrack </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>sequence</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sample a secondary structure from the Boltzmann ensemble according its probability<br/>
. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>You have to call <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a> first in order to fill the partition function matrices</dd>
<dd>
<b>OpenMP notice:</b><br/>
This function relies on passing the following variables to the appropriate <em>COPYIN</em> clause <em>(additionally to the ones needed by <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>)</em>:<br/>
 pstruc, sequence</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequence</em>&nbsp;</td><td>The RNA sequence <dl class="return"><dt><b>Returns:</b></dt><dd>A sampled secondary structure in dot-bracket notation </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a00474051204ac9ad576b3e45174d03ff"></a><!-- doxytag: member="part_func.h::pbacktrack_circ" ref="a00474051204ac9ad576b3e45174d03ff" args="(char *sequence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* pbacktrack_circ </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>sequence</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sample a secondary structure of a circular RNA from the Boltzmann ensemble according its probability. </p>
<p>This function does the same as <a class="el" href="part__func_8h.html#ac03ca6db186bb3bf0a2a326d7fb3ba03">pbacktrack()</a> but assumes the RNA molecule to be circular</p>
<dl class="note"><dt><b>Note:</b></dt><dd><b>OpenMP notice:</b><br/>
This function relies on passing the following variables to the appropriate <em>COPYIN</em> clause <em>(additionally to the ones needed by <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>)</em>:<br/>
 pstruc, sequence</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sequence</em>&nbsp;</td><td>The RNA sequence <dl class="return"><dt><b>Returns:</b></dt><dd>A sampled secondary structure in dot-bracket notation </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae73db3f49a94f0f72e067ecd12681dbd"></a><!-- doxytag: member="part_func.h::free_pf_arrays" ref="ae73db3f49a94f0f72e067ecd12681dbd" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_pf_arrays </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free arrays for the partition function recursions. </p>
<p>Call this function if you want to free all allocated memory associated with the partition function forward recursion. <dl class="note"><dt><b>Note:</b></dt><dd>Successive calls of <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>, <a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a> already check if they should free any memory from a previous run. </dd>
<dd>
<b>OpenMP notice:</b><br/>
 This function should be called before leaving a thread in order to avoid leaking memory</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>, <a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a384e927890f9c034ff09fa66da102d28"></a><!-- doxytag: member="part_func.h::update_pf_params" ref="a384e927890f9c034ff09fa66da102d28" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_pf_params </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Recalculate energy parameters. </p>
<p>Call this function to recalculate the pair matrix and energy parameters after a change in folding parameters like <a class="el" href="fold__vars_8h.html#ab4b11c8d9c758430960896bc3fe82ead" title="Rescale energy parameters to a temperature in degC.">temperature</a> </p>

</div>
</div>
<a class="anchor" id="ac5ac7ee281aae1c5cc5898a841178073"></a><!-- doxytag: member="part_func.h::export_bppm" ref="ac5ac7ee281aae1c5cc5898a841178073" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FLT_OR_DBL* export_bppm </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a pointer to the base pair probability array. </p>
<p>Accessing the base pair probabilities for a pair (i,j) is achieved by <div class="fragment"><pre class="fragment">FLT_OR_DBL *pr = export_bppm(); pr_ij = pr[iindx[i]-j]; </pre></div><dl class="note"><dt><b>Note:</b></dt><dd>Call <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a> before using this function!</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>, <a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a>, <a class="el" href="utils_8h.html#a55c0f6b3b07b6adf2ee235ba901fe397" title="Get an index mapper array (iindx) for accessing the energy matrices, e.g.">get_iindx()</a></dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to the base pair probability array </dd></dl>

</div>
</div>
<a class="anchor" id="a2f29542659beb5ebd176631a3da11580"></a><!-- doxytag: member="part_func.h::assign_plist_from_pr" ref="a2f29542659beb5ebd176631a3da11580" args="(plist **pl, FLT_OR_DBL *probs, int length, double cutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void assign_plist_from_pr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structplist.html">plist</a> **&nbsp;</td>
          <td class="paramname"> <em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL *&nbsp;</td>
          <td class="paramname"> <em>probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cutoff</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a plist from a probability matrix. </p>
<p>The probability matrix given is parsed and all pair probabilities above the given threshold are used to create an entry in the plist</p>
<p>The end of the plist is marked by sequence positions i as well as j equal to 0. This condition should be used to stop looping over its entries</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This function is threadsafe</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pl</em>&nbsp;</td><td>A pointer to the plist that is to be created <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>probs</em>&nbsp;</td><td>The probability matrix used for creting the plist <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the RNA sequence <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cutoff</em>&nbsp;</td><td>The cutoff value </td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a42faebdfce6f070c5f89adfc8427525c"></a><!-- doxytag: member="part_func.h::get_pf_arrays" ref="a42faebdfce6f070c5f89adfc8427525c" args="(short **S_p, short **S1_p, char **ptype_p, FLT_OR_DBL **qb_p, FLT_OR_DBL **qm_p, FLT_OR_DBL **q1k_p, FLT_OR_DBL **qln_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_pf_arrays </td>
          <td>(</td>
          <td class="paramtype">short **&nbsp;</td>
          <td class="paramname"> <em>S_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short **&nbsp;</td>
          <td class="paramname"> <em>S1_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>ptype_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL **&nbsp;</td>
          <td class="paramname"> <em>qb_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL **&nbsp;</td>
          <td class="paramname"> <em>qm_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL **&nbsp;</td>
          <td class="paramname"> <em>q1k_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL **&nbsp;</td>
          <td class="paramname"> <em>qln_p</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the pointers to (almost) all relavant computation arrays used in partition function computation. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>In order to assign meaningful pointers, you have to call pf_fold first!</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>, <a class="el" href="part__func_8h.html#a819ce5fca8984004ac81c4a3b04cb735" title="Compute the partition function of a circular RNA sequence.">pf_circ_fold()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S_p</em>&nbsp;</td><td>A pointer to the 'S' array (integer representation of nucleotides) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S1_p</em>&nbsp;</td><td>A pointer to the 'S1' array (2nd integer representation of nucleotides) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ptype_p</em>&nbsp;</td><td>A pointer to the pair type matrix <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qb_p</em>&nbsp;</td><td>A pointer to the Q<sup>B</sup> matrix <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qm_p</em>&nbsp;</td><td>A pointer to the Q<sup>M</sup> matrix <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>q1k_p</em>&nbsp;</td><td>A pointer to the 5' slice of the Q matrix (<img class="formulaInl" alt="$q1k(k) = Q(1, k)$" src="form_16.png"/>) <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>qln_p</em>&nbsp;</td><td>A pointer to the 3' slice of the Q matrix (<img class="formulaInl" alt="$qln(l) = Q(l, n)$" src="form_17.png"/>) <dl class="return"><dt><b>Returns:</b></dt><dd>Non Zero if everything went fine, 0 otherwise </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9aba0ba1433a6d259331e0fe9fc4a9a6"></a><!-- doxytag: member="part_func.h::get_centroid_struct_pl" ref="a9aba0ba1433a6d259331e0fe9fc4a9a6" args="(int length, double *dist, plist *pl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_centroid_struct_pl </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structplist.html">plist</a> *&nbsp;</td>
          <td class="paramname"> <em>pl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the centroid structure of the ensemble. </p>
<p>This function is a threadsafe replacement for <a class="el" href="part__func_8h.html#ae89a63bd83e75a80b2ba36d20b31ce81">centroid()</a> with a 'plist' input</p>
<p>The centroid is the structure with the minimal average distance to all other structures <br/>
 <img class="formulaInl" alt="$ <d(S)> = \sum_{(i,j) \in S} (1-p_{ij}) + \sum_{(i,j) \notin S} p_{ij} $" src="form_18.png"/> <br/>
 Thus, the centroid is simply the structure containing all pairs with <img class="formulaInl" alt="$p_ij>0.5$" src="form_19.png"/> The distance of the centroid to the ensemble is written to the memory adressed by <em>dist</em>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the sequence <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dist</em>&nbsp;</td><td>A pointer to the distance variable where the centroid distance will be written to <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pl</em>&nbsp;</td><td>A pair list containing base pair probability information about the ensemble <dl class="return"><dt><b>Returns:</b></dt><dd>The centroid structure of the ensemble in dot-bracket notation </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac92486ce514677256f4a832dc518759c"></a><!-- doxytag: member="part_func.h::get_centroid_struct_pr" ref="ac92486ce514677256f4a832dc518759c" args="(int length, double *dist, FLT_OR_DBL *pr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_centroid_struct_pr </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL *&nbsp;</td>
          <td class="paramname"> <em>pr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the centroid structure of the ensemble. </p>
<p>This function is a threadsafe replacement for <a class="el" href="part__func_8h.html#ae89a63bd83e75a80b2ba36d20b31ce81">centroid()</a> with a probability array input</p>
<p>The centroid is the structure with the minimal average distance to all other structures <br/>
 <img class="formulaInl" alt="$ <d(S)> = \sum_{(i,j) \in S} (1-p_{ij}) + \sum_{(i,j) \notin S} p_{ij} $" src="form_18.png"/> <br/>
 Thus, the centroid is simply the structure containing all pairs with <img class="formulaInl" alt="$p_ij>0.5$" src="form_19.png"/> The distance of the centroid to the ensemble is written to the memory adressed by <em>dist</em>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the sequence <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dist</em>&nbsp;</td><td>A pointer to the distance variable where the centroid distance will be written to <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pr</em>&nbsp;</td><td>A upper triangular matrix containing base pair probabilities (access via iindx <a class="el" href="utils_8h.html#a55c0f6b3b07b6adf2ee235ba901fe397">get_iindx()</a> ) <dl class="return"><dt><b>Returns:</b></dt><dd>The centroid structure of the ensemble in dot-bracket notation </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a79cbc375af65f11609feb6b055269e7d"></a><!-- doxytag: member="part_func.h::mean_bp_distance" ref="a79cbc375af65f11609feb6b055269e7d" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mean_bp_distance </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the mean base pair distance of the last partition function computation. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>To ensure thread-safety, use the function <a class="el" href="part__func_8h.html#ad5ba36cef8d01cf4244cc09b9bf1ce1d" title="Get the mean base pair distance in the thermodynamic ensemble.">mean_bp_distance_pr()</a> instead!</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#ad5ba36cef8d01cf4244cc09b9bf1ce1d" title="Get the mean base pair distance in the thermodynamic ensemble.">mean_bp_distance_pr()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td><dl class="return"><dt><b>Returns:</b></dt><dd>mean base pair distance in thermodynamic ensemble </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad5ba36cef8d01cf4244cc09b9bf1ce1d"></a><!-- doxytag: member="part_func.h::mean_bp_distance_pr" ref="ad5ba36cef8d01cf4244cc09b9bf1ce1d" args="(int length, FLT_OR_DBL *pr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mean_bp_distance_pr </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FLT_OR_DBL *&nbsp;</td>
          <td class="paramname"> <em>pr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the mean base pair distance in the thermodynamic ensemble. </p>
<p>This is a threadsafe implementation of <a class="el" href="part__func_8h.html#ae9556ba7ded44fe2321b6f67c3fc02a3">mean_bp_dist()</a> !</p>
<p><img class="formulaInl" alt="$<d> = \sum_{a,b} p_a p_b d(S_a,S_b)$" src="form_20.png"/><br/>
 this can be computed from the pair probs <img class="formulaInl" alt="$p_ij$" src="form_21.png"/> as<br/>
 <img class="formulaInl" alt="$<d> = \sum_{ij} p_{ij}(1-p_{ij})$" src="form_22.png"/></p>
<dl class="note"><dt><b>Note:</b></dt><dd>This function is threadsafe</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the sequence <dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pr</em>&nbsp;</td><td>The matrix containing the base pair probabilities <dl class="return"><dt><b>Returns:</b></dt><dd>The mean pair distance of the structure ensemble </dd></dl>
</td></tr>
  </table>
  </dd>
</dl>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a15176e23eceeff8c7d14eabcfec8a2af"></a><!-- doxytag: member="part_func.h::init_pf_fold" ref="a15176e23eceeff8c7d14eabcfec8a2af" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_pf_fold </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate space for <a class="el" href="part__func_8h.html#adc3db3d98742427e7001a7fd36ef28c2" title="Compute the partition function  of an RNA sequence.">pf_fold()</a>. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>This function is obsolete and will be removed soon! </dd></dl>

</div>
</div>
<a class="anchor" id="ae89a63bd83e75a80b2ba36d20b31ce81"></a><!-- doxytag: member="part_func.h::centroid" ref="ae89a63bd83e75a80b2ba36d20b31ce81" args="(int length, double *dist)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* centroid </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dist</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>This function is deprecated and should not be used anymore as it is not threadsafe! </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func_8h.html#a9aba0ba1433a6d259331e0fe9fc4a9a6" title="Get the centroid structure of the ensemble.">get_centroid_struct_pl()</a>, <a class="el" href="part__func_8h.html#ac92486ce514677256f4a832dc518759c" title="Get the centroid structure of the ensemble.">get_centroid_struct_pr()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ae9556ba7ded44fe2321b6f67c3fc02a3"></a><!-- doxytag: member="part_func.h::mean_bp_dist" ref="ae9556ba7ded44fe2321b6f67c3fc02a3" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mean_bp_dist </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>get the mean pair distance of ensemble </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000013">Deprecated:</a></b></dt><dd>This function is not threadsafe and should not be used anymore. Use <a class="el" href="part__func_8h.html#a79cbc375af65f11609feb6b055269e7d">mean_bp_distance()</a> instead! </dd></dl>

</div>
</div>
<a class="anchor" id="a68ba6f3a48e08ca131ab54621ce3a2d7"></a><!-- doxytag: member="part_func.h::expLoopEnergy" ref="a68ba6f3a48e08ca131ab54621ce3a2d7" args="(int u1, int u2, int type, int type2, short si1, short sj1, short sp1, short sq1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double expLoopEnergy </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>u1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>u2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>si1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>sj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>sp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>sq1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000014">Deprecated:</a></b></dt><dd>Use <a class="el" href="loop__energies_8h.html#aa5e98e524e2a41e290b942b09544bc9e">exp_E_IntLoop()</a> from <a class="el" href="loop__energies_8h.html" title="Energy evaluation for MFE and partition function calculations.">loop_energies.h</a> instead </dd></dl>

</div>
</div>
<a class="anchor" id="a7b6ab474cc80accc48010ccfcc59f96b"></a><!-- doxytag: member="part_func.h::expHairpinEnergy" ref="a7b6ab474cc80accc48010ccfcc59f96b" args="(int u, int type, short si1, short sj1, const char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double expHairpinEnergy </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>si1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>sj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>string</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000015">Deprecated:</a></b></dt><dd>Use <a class="el" href="loop__energies_8h.html#a0e128184bb097dc2da33706f33b555a6">exp_E_Hairpin()</a> from <a class="el" href="loop__energies_8h.html" title="Energy evaluation for MFE and partition function calculations.">loop_energies.h</a> instead </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue May 22 15:38:14 2012 for RNAlib-2.0.4 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
